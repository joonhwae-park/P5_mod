['rating_loss', 'sequential_loss', 'explanation_loss', 'review_loss', 'traditional_loss']
Process Launching at GPU 1
{'distributed': False, 'multiGPU': True, 'fp16': True, 'train': 'yelp', 'valid': 'yelp', 'test': 'yelp', 'batch_size': 16, 'optim': 'adamw', 'warmup_ratio': 0.02, 'lr': 0.001, 'num_workers': 4, 'clip_grad_norm': 1.0, 'losses': 'rating,sequential,explanation,review,traditional', 'backbone': 't5-small', 'output': 'snap/yelp-small', 'epoch': 10, 'local_rank': 0, 'comment': '', 'train_topk': -1, 'valid_topk': -1, 'dropout': 0.1, 'tokenizer': 'p5', 'max_text_length': 512, 'do_lower_case': False, 'word_mask_rate': 0.15, 'gen_max_length': 64, 'weight_decay': 0.01, 'adam_eps': 1e-06, 'gradient_accumulation_steps': 1, 'seed': 2022, 'whole_word_embed': True, 'world_size': 2, 'LOSSES_NAME': ['rating_loss', 'sequential_loss', 'explanation_loss', 'review_loss', 'traditional_loss', 'total_loss'], 'gpu': 1, 'rank': 1}
<class 'src.tokenization.P5Tokenizer'> t5-small
Building Model at GPU 1
Model loaded from  ../snap/yelp-small.pth
<All keys matched successfully>
len(test_review_data): 31636
test_review_data[0]: {'review_id': 'Vx-DPb4olxt1Zxf9dI8b2A', 'useful': 0, 'funny': 0, 'cool': 0, 'date': '2019-01-02 19:11:49', 'unixReviewTime': '20190102191149', 'reviewerID': 'Donht4mLJ4aO4FQhqHGJtw', 'asin': '5eV8oUGdBXylwB7HeaDFOA', 'overall': 4.0, 'reviewText': 'Top notch cuisine and very friendly service. Everything here tastes very fresh. The rice pilaf is second to none!! Prices are very reasonable for the high quality food they serve!!', 'explanation': 'Everything here tastes very fresh', 'feature': 'taste'}
30431
20033
Data sources:  ['yelp']
compute_datum_info
1978
RMSE  1.4687
MAE  1.0055
Data sources:  ['yelp']
compute_datum_info
1978
RMSE  1.4868
MAE  1.0186
Data sources:  ['yelp']
compute_datum_info
1902

NDCG@5	Rec@5	Hits@5	Prec@5	MAP@5	MRR@5
0.0405	0.0576	0.0576	0.0115	0.0347	0.0347

NDCG@10	Rec@10	Hits@10	Prec@10	MAP@10	MRR@10
0.0447	0.0709	0.0709	0.0071	0.0365	0.0365
Data sources:  ['yelp']
compute_datum_info
1902

NDCG@5	Rec@5	Hits@5	Prec@5	MAP@5	MRR@5
0.0403	0.0568	0.0568	0.0114	0.0347	0.0347

NDCG@10	Rec@10	Hits@10	Prec@10	MAP@10	MRR@10
0.0447	0.0706	0.0706	0.0071	0.0366	0.0366
Data sources:  ['yelp']
compute_datum_info
1529
BLEU-1 21.3121
BLEU-4  3.0585
rouge_1/f_score 27.3007
rouge_1/r_score 28.7351
rouge_1/p_score 30.5544
rouge_2/f_score  6.7642
rouge_2/r_score  7.7771
rouge_2/p_score  7.1707
rouge_l/f_score 19.6333
rouge_l/r_score 24.0232
rouge_l/p_score 23.4898
Data sources:  ['yelp']
compute_datum_info
1529
BLEU-1 21.2438
BLEU-4  2.9743
rouge_1/f_score 27.1834
rouge_1/r_score 28.6137
rouge_1/p_score 30.3869
rouge_2/f_score  6.6826
rouge_2/r_score  7.6807
rouge_2/p_score  7.0873
rouge_l/f_score 19.6309
rouge_l/r_score 23.9856
rouge_l/p_score 23.5471
Data sources:  ['yelp']
compute_datum_info
1529
BLEU-1 14.0835
BLEU-4  1.2743
rouge_1/f_score 18.1814
rouge_1/r_score 18.2447
rouge_1/p_score 21.1174
rouge_2/f_score  2.9478
rouge_2/r_score  3.3080
rouge_2/p_score  3.1613
rouge_l/f_score 13.5517
rouge_l/r_score 15.8689
rouge_l/p_score 16.6546
Data sources:  ['yelp']
compute_datum_info
1978
RMSE  0.6350
MAE  0.3150
Data sources:  ['yelp']
compute_datum_info
1978
RMSE  0.6301
MAE  0.3113
Data sources:  ['yelp']
compute_datum_info
1902

NDCG@1	Rec@1	Hits@1	Prec@1	MAP@1	MRR@1
0.0651	0.0651	0.0651	0.0651	0.0651	0.0651

NDCG@5	Rec@5	Hits@5	Prec@5	MAP@5	MRR@5
0.1204	0.1733	0.1733	0.0347	0.1030	0.1030

NDCG@10	Rec@10	Hits@10	Prec@10	MAP@10	MRR@10
0.1472	0.2568	0.2568	0.0257	0.1140	0.1140
Data sources:  ['yelp']
compute_datum_info
1902

NDCG@1	Rec@1	Hits@1	Prec@1	MAP@1	MRR@1
0.0645	0.0645	0.0645	0.0645	0.0645	0.0645

NDCG@5	Rec@5	Hits@5	Prec@5	MAP@5	MRR@5
0.1215	0.1757	0.1757	0.0351	0.1036	0.1036

NDCG@10	Rec@10	Hits@10	Prec@10	MAP@10	MRR@10
0.1480	0.2581	0.2581	0.0258	0.1145	0.1145
