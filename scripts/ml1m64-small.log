Configurations
{'adam_beta1': 0.9,
 'adam_beta2': 0.999,
 'adam_eps': 1e-06,
 'backbone': 't5-small',
 'batch_size': 16,
 'clip_grad_norm': 1.0,
 'comment': '',
 'distributed': True,
 'do_lower_case': False,
 'dropout': 0.1,
 'dry': False,
 'epoch': 10,
 'fp16': False,
 'from_scratch': False,
 'gen_max_length': 64,
 'gradient_accumulation_steps': 1,
 'load': None,
 'local_rank': 0,
 'log_train_accuracy': False,
 'losses': 'rating,sequential,explanation,review,traditional',
 'lr': 0.001,
 'max_text_length': 512,
 'multiGPU': True,
 'num_beams': 1,
 'num_workers': 4,
 'optim': 'adamw',
 'optimizer': 'adamw',
 'output': 'snap/ml1m64-small',
 'seed': 2022,
 'submit': False,
 'test': None,
 'test_only': False,
 'tokenizer': 'p5',
 'train': 'ml1m',
 'valid': 'ml1m',
 'valid_batch_size': None,
 'warmup_ratio': 0.02,
 'weight_decay': 0.01,
 'whole_word_embed': True}
Configuring task lists for ML1M dataset: ml1m
Process Launching at GPU 3
Configuring task lists for ML1M dataset: ml1m
Process Launching at GPU 1
Configuring task lists for ML1M dataset: ml1m
Process Launching at GPU 2
['rating_loss', 'sequential_loss', 'explanation_loss', 'review_loss', 'traditional_loss']
Configuring task lists for ML1M dataset: ml1m
Process Launching at GPU 0
Building train loader at GPU 0
Building train loader at GPU 3
Building train loader at GPU 1
Building train loader at GPU 2
Data sources root: /scratch/jpa2742/P5/data/ml1m
Data sources root: /scratch/jpa2742/P5/data/ml1m
Data sources root: /scratch/jpa2742/P5/data/ml1m
Data sources root: /scratch/jpa2742/P5/data/ml1m
Computing datum_info for P5_ML1M_Dataset...
Computing datum_info for P5_ML1M_Dataset...
Computing datum_info for P5_ML1M_Dataset...
Computing datum_info for P5_ML1M_Dataset...
Total number of samples for mode 'train': 1632958
Building val loader at GPU 3
Total number of samples for mode 'train': 1632958
Building val loader at GPU 2
Data sources root: /scratch/jpa2742/P5/data/ml1m
Total number of samples for mode 'train': 1632958
Building val loader at GPU 1
Data sources root: /scratch/jpa2742/P5/data/ml1m
Total number of samples for mode 'train': 1632958
Building val loader at GPU 0
Data sources root: /scratch/jpa2742/P5/data/ml1m
Data sources root: /scratch/jpa2742/P5/data/ml1m
Computing datum_info for P5_ML1M_Dataset...
Computing datum_info for P5_ML1M_Dataset...
Computing datum_info for P5_ML1M_Dataset...
Total number of samples for mode 'val': 367256
Total number of samples for mode 'val': 367256
Computing datum_info for P5_ML1M_Dataset...
Total number of samples for mode 'val': 367256
Building Model at GPU 3
Total number of samples for mode 'val': 367256
Building Model at GPU 1
Building Model at GPU 2
Building Model at GPU 0
Model Launching at GPU 3
Model Launching at GPU 0
Model Launching at GPU 2
Model Launching at GPU 1
Building Optimizer
Batch per epoch: 25515
Total Iters: 255150
Warmup ratio: 0.02
Warm up Iters: 5103
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO Bootstrap : Using enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO NET/IB : No device found.
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO NET/Socket : Using [0]enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO Using network Socket
hyper-01-prod-comp-di-0241-178:131501:131501 [1] NCCL INFO Bootstrap : Using enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131501:131501 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
hyper-01-prod-comp-di-0241-178:131501:131501 [1] NCCL INFO NET/IB : No device found.
hyper-01-prod-comp-di-0241-178:131501:131501 [1] NCCL INFO NET/Socket : Using [0]enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131501:131501 [1] NCCL INFO Using network Socket
NCCL version 2.10.3+cuda11.3
hyper-01-prod-comp-di-0241-178:131503:131503 [3] NCCL INFO Bootstrap : Using enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131503:131503 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
hyper-01-prod-comp-di-0241-178:131503:131503 [3] NCCL INFO NET/IB : No device found.
hyper-01-prod-comp-di-0241-178:131503:131503 [3] NCCL INFO NET/Socket : Using [0]enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131503:131503 [3] NCCL INFO Using network Socket
hyper-01-prod-comp-di-0241-178:131502:131502 [2] NCCL INFO Bootstrap : Using enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131502:131502 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
hyper-01-prod-comp-di-0241-178:131502:131502 [2] NCCL INFO NET/IB : No device found.
hyper-01-prod-comp-di-0241-178:131502:131502 [2] NCCL INFO NET/Socket : Using [0]enp135s0:10.66.241.178<0>
hyper-01-prod-comp-di-0241-178:131502:131502 [2] NCCL INFO Using network Socket
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Channel 00/02 :    0   1   2   3
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Channel 01/02 :    0   1   2   3
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Channel 00 : 0[9f000] -> 1[a1000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Channel 01 : 0[9f000] -> 1[a1000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Channel 00 : 3[a5000] -> 0[9f000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Channel 01 : 3[a5000] -> 0[9f000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Channel 00 : 1[a1000] -> 2[a3000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Channel 01 : 1[a1000] -> 2[a3000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Channel 00 : 2[a3000] -> 3[a5000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Channel 01 : 2[a3000] -> 3[a5000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Connected all rings
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Connected all rings
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Connected all rings
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Channel 00 : 3[a5000] -> 2[a3000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Could not enable P2P between dev 3(=a5000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Channel 01 : 3[a5000] -> 2[a3000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Could not enable P2P between dev 0(=9f000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 2(=a3000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Connected all rings
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Channel 00 : 1[a1000] -> 0[9f000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Could not enable P2P between dev 1(=a1000) and dev 0(=9f000)
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Channel 01 : 1[a1000] -> 0[9f000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 3(=a5000)
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO Connected all trees
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/512
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Channel 00 : 2[a3000] -> 1[a1000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Could not enable P2P between dev 2(=a3000) and dev 1(=a1000)
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Channel 01 : 2[a3000] -> 1[a1000] via direct shared memory
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO Connected all trees
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/512
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO Connected all trees
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/512
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO Connected all trees
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/512
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO 2 coll channels, 2 p2p channels, 2 p2p channels per peer
hyper-01-prod-comp-di-0241-178:131503:216574 [3] NCCL INFO comm 0x7f09540030d0 rank 3 nranks 4 cudaDev 3 busId a5000 - Init COMPLETE
hyper-01-prod-comp-di-0241-178:131501:211406 [1] NCCL INFO comm 0x7fafcc0030d0 rank 1 nranks 4 cudaDev 1 busId a1000 - Init COMPLETE
hyper-01-prod-comp-di-0241-178:131500:211442 [0] NCCL INFO comm 0x7faba00030d0 rank 0 nranks 4 cudaDev 0 busId 9f000 - Init COMPLETE
hyper-01-prod-comp-di-0241-178:131502:218055 [2] NCCL INFO comm 0x7fb7500030d0 rank 2 nranks 4 cudaDev 2 busId a3000 - Init COMPLETE
hyper-01-prod-comp-di-0241-178:131500:131500 [0] NCCL INFO Launch mode Parallel
It took 25.9s
Train Loss: 0.784
rating_loss (640830): 0.559 review_loss (640830): 0.671 sequential_loss (117100): 2.867 total_loss (1632960): 0.784 traditional_loss (234200): 0.670 

Skip validation for Epoch01Skip validation for Epoch01

Skip validation for Epoch01
Skip validation for Epoch01
Train Loss: 0.733
rating_loss (640829): 0.512 review_loss (640831): 0.630 sequential_loss (117100): 2.712 total_loss (1632960): 0.733 traditional_loss (234200): 0.630 

Skip validation for Epoch02Skip validation for Epoch02

Skip validation for Epoch02
Skip validation for Epoch02
Train Loss: 0.723
rating_loss (640829): 0.507 review_loss (640831): 0.622 sequential_loss (117100): 2.654 total_loss (1632960): 0.723 traditional_loss (234200): 0.622 

Skip validation for Epoch03
Skip validation for Epoch03
Skip validation for Epoch03
Skip validation for Epoch03
Train Loss: 0.717
rating_loss (640830): 0.503 review_loss (640830): 0.619 sequential_loss (117100): 2.610 total_loss (1632960): 0.717 traditional_loss (234200): 0.619 

Skip validation for Epoch04
Skip validation for Epoch04
Skip validation for Epoch04
Skip validation for Epoch04
Train Loss: 0.710
rating_loss (640829): 0.501 review_loss (640830): 0.615 sequential_loss (117101): 2.568 total_loss (1632960): 0.710 traditional_loss (234200): 0.614 

Skip validation for Epoch05Skip validation for Epoch05

Skip validation for Epoch05
Skip validation for Epoch05
Train Loss: 0.703
rating_loss (640830): 0.497 review_loss (640829): 0.610 sequential_loss (117100): 2.527 total_loss (1632960): 0.703 traditional_loss (234201): 0.610 

Skip validation for Epoch06
Skip validation for Epoch06
Skip validation for Epoch06
Skip validation for Epoch06
Train Loss: 0.695
rating_loss (640831): 0.492 review_loss (640829): 0.604 sequential_loss (117100): 2.483 total_loss (1632960): 0.695 traditional_loss (234200): 0.603 

Skip validation for Epoch07
Skip validation for Epoch07
Skip validation for Epoch07
Skip validation for Epoch07
Train Loss: 0.687
rating_loss (640829): 0.488 review_loss (640830): 0.598 sequential_loss (117100): 2.438 total_loss (1632960): 0.687 traditional_loss (234201): 0.598 

Skip validation for Epoch08
Skip validation for Epoch08
Skip validation for Epoch08
Skip validation for Epoch08
Train Loss: 0.679
rating_loss (640831): 0.483 review_loss (640829): 0.592 sequential_loss (117100): 2.393 total_loss (1632960): 0.679 traditional_loss (234200): 0.593 

Skip validation for Epoch09
Skip validation for Epoch09
Skip validation for Epoch09
Skip validation for Epoch09
Train Loss: 0.671
rating_loss (640830): 0.480 review_loss (640830): 0.587 sequential_loss (117100): 2.348 total_loss (1632960): 0.671 traditional_loss (234200): 0.586 

Skip validation for Epoch10
Skip validation for Epoch10
Skip validation for Epoch10
Skip validation for Epoch10
